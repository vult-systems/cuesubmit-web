services:
  cuesubmit-web:
    build: .
    container_name: cuesubmit-web
    restart: unless-stopped
    network_mode: host
    environment:
      - CUEWEB_MODE=online
      - CUEWEB_API_BASE=http://127.0.0.1:8448
      - REST_GATEWAY_URL=http://127.0.0.1:8448
      - JWT_SECRET=${JWT_SECRET:?JWT_SECRET is required}
      - SESSION_SECRET=${SESSION_SECRET:?SESSION_SECRET is required}
      - DATABASE_PATH=/app/data/cuesubmit.db
      - ADMIN_INITIAL_PASSWORD=${ADMIN_INITIAL_PASSWORD:?ADMIN_INITIAL_PASSWORD is required}
      - OPENCUE_DB_HOST=${OPENCUE_DB_HOST:-localhost}
      - OPENCUE_DB_PASSWORD=${OPENCUE_DB_PASSWORD:-}
      - FILE_SERVER_IP=${FILE_SERVER_IP:-localhost}
      - NEXT_PUBLIC_FILE_SERVER_IP=${NEXT_PUBLIC_FILE_SERVER_IP:-localhost}
      - RENDER_REPO_PATH=/mnt/RenderOutputRepo
      - RENDER_SOURCE_PATH=/mnt/RenderSourceRepository
    volumes:
      - cuesubmit-data:/app/data
      - /angd_server_pool/renderRepo:/mnt/RenderOutputRepo:ro
      - /opt/perforce/deadlineRenderSource:/mnt/RenderSourceRepository:ro

volumes:
  cuesubmit-data:
